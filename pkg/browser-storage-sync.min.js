function syncedStorage(t,n){const a={localId:localStorage.getItem("storage-id"),on:function(e,t){e=r[e];typeof e+typeof t=="objectfunction"&&e.indexOf(t)<0&&e.push(t)},off:function(e,t){e=r[e];typeof e+typeof t=="objectfunction"?0<=(t=e.indexOf(t))&&e.splice(t,1):e&&e.splice(0,e.length)},setItem:function(e,t){{if(/^tab_|^controller_tab_/.test(e))return localStorage.setItem(e,t);{const o={id:a.localId,key:e,newValue:t,oldValue:localStorage.getItem(e)};localStorage.setItem(e,t),n({storageLink:o}),r.change.forEach(function(e){e(o)}),r.localChange.forEach(function(e){e(o)})}}},getItem:localStorage.getItem.bind(localStorage)},r={change:[],remoteChange:[],localChange:[],peerWindowChange:[]};return getLocalId().then(function(e){Object.defineProperties(a,{localId:{value:e,enumerable:!0,configurable:!0}}),typeof t+typeof n=="functionfunction"&&(t(c),window.addEventListener("storage",o))}),a;function o(e){/^tab_|^controller_tab_/.test(e.key)||(e={id:a.localId,key:e.key,newValue:e.newValue,oldValue:e.oldValue},n({storageLink:e}),r.change.forEach(function(e){e(obj)}),r.remoteChange.forEach(function(e){e(obj)}))}function c(e){if("string"==typeof e&&e.startsWith('{"'))try{var t=JSON.parse(e).storageLink||null;if(!(t&&t.key&&t.newValue))return t;localStorage.setItem(t.key,t.newValue),r.change.forEach(function(e){e(obj)}),r.peerWindowChange.forEach(function(e){e(obj)})}catch(e){}return null}}function getLocalId(){var e=localStorage.getItem("storage-id");return e?Promise.resolve(e):new Promise(generateLocalId)}function generateLocalId(o,n){var e=new TextEncoder,t=`storage-id-${Math.random()}-${Date.now()} `+Math.random();crypto.subtle.digest("SHA-512",e.encode(t)).then(function(e){var e=new Blob([e]),t=new FileReader;t.onload=function(e){var[,e]=e.target.result.split(",");o(e)},t.onerror=function(e){n(e)},t.readAsDataURL(e)}).catch(n)}