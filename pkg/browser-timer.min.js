/*!
 * timer.js
 * Copyright(c) 2023 Jonathan Annett
 * MIT Licensed
 */
const oneSecond=1e3,oneMinute=60*oneSecond,skip_granularity=15*oneSecond;var timerWin;window.addEventListener("unload",onControlUnload);let doc=document,qs=doc.querySelector.bind(doc),getEl=doc.getElementById.bind(doc),shifting=!1,controlling=!1,stylesheet1=getEl("style_1"),stylesheet1_obj;replaceStylesheet(stylesheet1,function(e){stylesheet1_obj=e});let aceScript,elapsedDisp=getEl("elapsed_disp"),remainDisp=getEl("remain_disp"),startedDisp=getEl("started_disp"),endsDisp=getEl("ends_disp"),remainInfoDisp=getEl("remain_info_message"),custom_message=getEl("custom_message"),durationDisp=getEl("duration_disp"),extraTimeDisp=getEl("extra_time_disp"),nowDisp=getEl("now_disp"),keyDisp=getEl("key_disp"),dispNextMins=getEl("disp_next_mins"),html=qs("html"),progress=qs(".progress"),pausedAt,pauseAcum=0,runMode="controller",togglePIPMode=setupPip("remain_disp","remain_disp_video",384,216,'100px "Lucida", sans-serif',"#remain_disp_video_text","overlay","#remain_disp_video_text",'40px "Lucida", sans-serif'),defaultDuration=(window.location.search.startsWith("?presenter")?(html.classList.add("reduced"),runMode="presenter",fs_api.isFullscreen()?document.title="Presentation Timer - Remote Screen (Fullscreen)":document.title="Presentation Timer - Remote Screen"):fs_api.isFullscreen()?document.title="Presentation Timer - Control Screen (Fullscreen)":document.title="Presentation Timer - Control Screen",readNumber("defaultDuration",10*oneMinute)),thisDuration=defaultDuration,startedAt=readNumber("startedAt",Date.now()),endsAt=readNumber("endsAt",startedAt+defaultDuration),seekEndsAt=readNumber("seekEndsAt",endsAt),lastUpdateTick=0,lastTimeText="",lastEndsAtText="",enterTimeText="",enterHoursText="",restartNeeded=(window.tab_id="tab_"+Date.now().toString(),custom_message.addEventListener("focus",function(){setTimeout(function(){document.execCommand("selectAll",!1,null)},2)}),progress.style.width="0%",dispNextMins.textContent=secToStr(defaultDuration/1e3),isNaN(startedAt)||isNaN(endsAt));if(!restartNeeded){let e=6e5;(Date.now()>endsAt+e||Date.now()>seekEndsAt+e)&&(restartNeeded=!0)}function keyMacroClick(t){if("mouse"!==t.pointerType||0===t.button){let e=this.dataset.keys.split(",").map(function(e){return e.startsWith("!")?{key:e.substr(1),__up:!0}:{key:e}});if(t.shiftKey&&" "===e[0].key){if(""!==enterTimeText)return this.dataset.keys=" ,"+enterTimeText.split("").join(",")+", ",this.innerHTML=enterTimeText,clearHtmlClass("editing"),dispNextMins.textContent=secToStr(defaultDuration/1e3),void(enterTimeText="");e=this.dataset.keys.split(",").map(function(e){return" "===e?{key:"Enter"}:{key:e}})}e.forEach(function(e){(e.__up?onDocKeyUp:onDocKeyDown)(e)})}}function openTimerWindow(e){return!0===e?(timerWin&&timerWin.close(),window.opener&&window.close(),timerWin=void 0):(timerWin=open("timer.html?presenter","remote_timer_window","location=0"))&&timerWin.addEventListener("load",function(){console.log("timer win loaded"),timerWin.addEventListener("unload",onTimerWinUnload)}),!1}function displayUpdate(){var t=getTabCount(),a=Date.now(),r=getTabCount(!0);let i=!1,o=!1,l=!1,d="0",c;if((1===t?clearHtmlClass:setHtmlClass)("twoplus"),fs_api.isFullscreen()?"presenter"===runMode?document.title="Presentation Timer - Remote Screen (Fullscreen)":"controller"===runMode?document.title="Presentation Timer - Control Screen (Fullscreen)":document.title="Presentation Timer (Fullscreen)":"presenter"===runMode?document.title=1===t?"Presentation Timer - Single Window":"Presentation Timer - Remote Screen":"controller"===runMode?document.title="Presentation Timer - Control Screen":document.title="Presentation Timer","controller"===runMode||1===t){var m=pausedAt?a-pausedAt:0;let e=(seekEndsAt-a)/oneSecond;0<e&&e++,c=secToStr(e),seekEndsAt<endsAt-500?(seekEndsAt,endsAt,skip_granularity,endsAt-=25,clearRemainClass("adjustingDown"),setRemainClass("adjusting"),d=Number((endsAt-seekEndsAt)/oneSecond).toFixed(1),keyDisp.textContent="speeding up to match actual time ("+c+")  "+d+" seconds offset",writeNumber("endsAt",endsAt),l=!0):seekEndsAt>endsAt+500?(seekEndsAt,endsAt,skip_granularity,endsAt+=25,clearRemainClass("adjusting"),setRemainClass("adjustingDown"),d=Number((endsAt-seekEndsAt)/oneSecond).toFixed(1),keyDisp.textContent="slowing down to match actual time ("+c+")  "+d+" seconds offset",writeNumber("endsAt",endsAt),o=!0):(endsAt=seekEndsAt,clearRemainClass("adjusting"),clearRemainClass("adjustingDown"),c=void 0,keyDisp.textContent=1===t?"":1<r?"MULTIPLE CONTROLLERS TABS ARE OPEN. CLOSE ONE!":0==m?"remote display active":"countdown was paused at "+local24HourTime(new Date(pausedAt)),writeNumber("endsAt",endsAt));var u,r=(endsAt-a+m)/oneSecond;let s,n;0!=m?(p=secToStr(m/oneSecond),remainInfoDisp.textContent="presenter"===runMode?"Paused":p,endsDisp.textContent=local24HourTime(new Date(seekEndsAt+m)),u=secToStr((pauseAcum+m)/oneSecond),extraTimeDisp.textContent="+ "+u+" pauses",i=!0,timerAPI&&lastEndsAtText!==endsDisp.textContent&&(lastEndsAtText=endsDisp.textContent,timerAPI.send({setVariableValues:{adjusting_up:l,adjusting_down:o,adjusting_delta:d,remain_actual:c,endsAt:lastEndsAtText,paused:p,pauses:u,pausing:i}}))):(remainInfoDisp.textContent="",0===pauseAcum?extraTimeDisp.textContent="":extraTimeDisp.textContent="+ "+secToStr(pauseAcum/oneSecond)+" pauses");var p=a-startedAt-(m+pauseAcum);if(p<0?(setHtmlClass("future"),(-6e4<p?setHtmlClass:clearHtmlClass)("impending"),seekEndsAt=startedAt+thisDuration,bumpEnd(0,0),endsAt=seekEndsAt,n=secToStr((0-p)/oneSecond),elapsedDisp.textContent=n,s=secToStr(thisDuration/1e3),localStorage.setItem("elapsedDisp",n)):(clearHtmlClass("future"),s=secToStr(0<=r?1+r:0-r),n=secToStr(p/oneSecond)),lastTimeText!==s&&(0===lastUpdateTick||750<a-lastUpdateTick)){lastUpdateTick=a,remainDisp.textContent=s,elapsedDisp.textContent=n,lastTimeText=s;let e=!1,t=!1;0<=r?(clearHtmlClass("over"),0<=p&&(r<=60?(setHtmlClass("impending"),t=!0):clearHtmlClass("impending")),setBar(p,thisDuration)):(e=!0,setHtmlClass("over"),clearHtmlClass("impending"),setBarPct(100)),localStorage.setItem("remainDisp",s),timerAPI&&timerAPI.send({setVariableValues:{adjusting_up:l,adjusting_down:o,adjusting_delta:d,remain_actual:c||s,expired:e,impending:t,pausing:i,remain:s,elapsed:n}})}localStorage.setItem("remainDispClass",html.className)}else keyDisp.textContent=t+" tabs open";nowDisp.textContent=timeNowStr()}function updateEnteredTimeText(){""===enterHoursText?dispNextMins.textContent=secToStr(60*Number(enterTimeText)):dispNextMins.textContent=secToStr(3600*Number(enterHoursText)+60*Number(enterTimeText))}function replaceStylesheet(a,r){var e=a.href;let s=new XMLHttpRequest,i;s.responseType="text",s.open("GET",e),s.onreadystatechange=function(){if(4==s.readyState){i=this.responseText;let e,s,n=document.createElement("style");n.innerHTML=i;var t=localStorage.getItem("custom_css");t&&(n.innerHTML=t),document.body.appendChild(n),a.parentNode.removeChild(a),r&&r(Object.defineProperties({},{sheet:{value:n},css:{set:function(e){n.innerHTML=e},get:function(){return n.innerHTML}},reset:{value:function(){n.innerHTML=i,localStorage.removeItem("custom_css")}},editToggle:{value:function(){if(e)n.innerHTML=e.getValue(),localStorage.setItem("custom_css",n.innerHTML),s.parentNode.removeChild(s),e=void 0;else{let t=function(){(s=document.createElement("pre")).id="css_editor",document.body.appendChild(s),setTimeout(function(){(e=ace.edit("css_editor")).setTheme("ace/theme/chrome"),e.session.setMode("ace/mode/css"),e.setValue(n.innerHTML),e.focus(),e.gotoLine(1)},10)};if(aceScript){let e=setInterval(function(){window.ace&&(clearInterval(e),t())},100)}else{(aceScript=document.createElement("script")).setAttribute("integrity","sha512-NSbvq6xPdfFIa2wwSh8vtsPL7AyYAYRAUWRDCqFH34kYIjQ4M7H2POiULf3CH11TRcq3Ww6FZDdLZ8msYhMxjg=="),aceScript.setAttribute("crossorigin","anonymous"),aceScript.setAttribute("referrerpolicy","no-referrer"),aceScript.setAttribute("src","https://cdnjs.cloudflare.com/ajax/libs/ace/1.15.2/ace.js"),document.body.appendChild(aceScript);let e=setInterval(function(){window.ace&&(clearInterval(e),t())},100)}}}},editing:{get:function(){return!!e}}}))}},s.send()}function restartTimer(){lastUpdateTick=0,startedAt=Date.now(),endsAt=startedAt+defaultDuration,pausedAt=void 0,pauseAcum=0,thisDuration=defaultDuration,seekEndsAt=endsAt,startedDisp.textContent=local24HourTime(new Date(startedAt)),endsDisp.textContent=local24HourTime(new Date(endsAt)),durationDisp.textContent=secToStr(defaultDuration/1e3),extraTimeDisp.textContent="",writeNumber("pausedAt",pausedAt),writeNumber("pauseAcum",pauseAcum),writeNumber("startedAt",startedAt),writeNumber("endsAt",endsAt),writeNumber("seekEndsAt",seekEndsAt),clearHtmlClass("countup-override"),clearHtmlClass("paused"),setBarPct(0),timerAPI&&timerAPI.send({setVariableValues:{startedAt:startedDisp.textContent,endsAt:endsDisp.textContent,default:durationDisp.textContent,paused:"0:00",pauses:"0:00",pausing:!1,expired:!1,showpresenter:html.classList.contains("reduced")?"1":"0",impending:defaultDuration<=6e4}})}function setPresenterMode(){runMode="presenter",html.classList.add("reduced"),timerAPI&&timerAPI.send({setVariableValues:{showpresenter:"1"}})}function setControllerMode(){runMode="controller",html.classList.remove("reduced"),timerAPI&&timerAPI.send({setVariableValues:{showpresenter:"0"}})}function extendDefaultToCurrentTimer(){lastUpdateTick=0,endsAt=startedAt+defaultDuration,thisDuration=defaultDuration,writeNumber("endsAt",seekEndsAt=endsAt),writeNumber("seekEndsAt",seekEndsAt),durationDisp.textContent=secToStr(defaultDuration/1e3),displayUpdate()}function onLocalStorage(e){var t;"presenter"!==runMode||"showbar"!==e.key&&!e.key.startsWith("remainDisp")||(remainDisp.textContent=localStorage.getItem("remainDisp"),html.className=localStorage.getItem("remainDispClass")+" reduced",1===readNumber("showbar",0)?(setHtmlClass("showbar"),setBarPct(Number(localStorage.getItem("barpct")))):clearHtmlClass("showbar")),"elapsedDisp"===e.key&&(elapsedDisp.textContent=localStorage.getItem("elapsedDisp")),"showtimenow"===e.key&&(1===readNumber("showtimenow",0)?setHtmlClass:clearHtmlClass)("showtimenow"),"showmessages"===e.key&&(1===readNumber("showmessages",0)?setHtmlClass:clearHtmlClass)("showmessages"),"custom_message"===e.key&&(t=localStorage.getItem("custom_message"),(""===(custom_message.textContent=t)?clearHtmlClass:setHtmlClass)("show_custom_message")),stylesheet1_obj&&!stylesheet1_obj.editing&&"custom_css"===e.key&&((t=localStorage.getItem("custom_css"))?stylesheet1_obj.css=t:stylesheet1_obj.reset())}function getTabCount(t){var s=[];let n=1,e=Date.now(),a=e-3e3;t||(writeNumber(tab_id,e),"controller"===runMode?writeNumber("controller_"+tab_id,e):localStorage.removeItem("controller_"+tab_id));for(let e=0;e<localStorage.length;e++){var r=localStorage.key(e);r!==tab_id&&r.startsWith("tab_")?Number(localStorage.getItem(r))<a?s.push(r):(!t||0<readNumber("controller_"+r,0))&&n++:r.startsWith("controller_tab_")&&Number(localStorage.getItem(r))<a&&s.push(r)}return s.forEach(function(e){localStorage.removeItem(e)}),n}restartNeeded?restartTimer():((Date.now()>endsAt||Date.now()>seekEndsAt)&&(endsAt=seekEndsAt,setHtmlClass("over")),startedDisp.textContent=local24HourTime(new Date(startedAt)),endsDisp.textContent=local24HourTime(new Date(endsAt)),durationDisp.textContent=secToStr((endsAt-startedAt)/1e3),pausedAt=readNumber("pausedAt",pausedAt),pauseAcum=readNumber("pauseAcum",pauseAcum),void 0!==pausedAt&&setHtmlClass("paused"),displayUpdate(),(1===readNumber("showbar",0)?setHtmlClass:clearHtmlClass)("showbar"),(1===readNumber("showtimenow",0)?setHtmlClass:clearHtmlClass)("showtimenow"),(1===readNumber("showmessages",0)?setHtmlClass:clearHtmlClass)("showmessages"),localStorage.setItem("remainDispClass",html.className)),dispNextMins.textContent=secToStr(defaultDuration/oneSecond),setInterval(displayUpdate,100),doc.addEventListener("keyup",onDocKeyUp),doc.addEventListener("keydown",onDocKeyDown),doc.addEventListener("contextmenu",function(e){e.preventDefault()}),addEventListener("storage",onLocalStorage),[].forEach.call(document.querySelectorAll("div.buttons div.btn"),function(e){e.addEventListener("pointerdown",keyMacroClick)});let custom_msg_timeout;function onDocKeyDown(e){function t(){controlling=e.ctrlKey,html.classList[controlling?"add":"remove"]("controlling"),shifting=e.shiftKey,html.classList[shifting?"add":"remove"]("shifting")}if(html.classList.contains("edit_custom_message"))return"Enter"===e.key&&(custom_message.contentEditable=!1,html.classList.remove("edit_custom_message"),"custom message"===custom_message.textContent?(html.classList.remove("show_custom_message"),localStorage.setItem("custom_message","")):(html.classList.add("show_custom_message"),custom_msg_timeout=setTimeout(function(){custom_msg_timeout=void 0,localStorage.setItem("custom_message",custom_message.textContent)},500))),t();if(html.classList.contains("show_custom_message")&&("c"===e.key||"C"===e.key))return html.classList.remove("edit_custom_message"),html.classList.remove("show_custom_message"),custom_msg_timeout&&(clearTimeout(custom_msg_timeout),custom_msg_timeout=void 0),localStorage.setItem("custom_message",""),t();if(stylesheet1_obj&&stylesheet1_obj.editing)return"S"!==e.key&&"s"!==e.key||!e.ctrlKey||(e.preventDefault(),stylesheet1_obj.editToggle(),e.shiftKey&&stylesheet1_obj.reset()),t();var s=getTabCount(),n=Date.now(),a=controlling?6e4:1e3,r=controlling?6e4:0,i=controlling?6e4:1e3;if("string"==typeof e.key&&(1<=e.key&&e.key<=9||"0"===e.key))enterTimeText=enterTimeText+""+e.key,setHtmlClass("editing"),updateEnteredTimeText();else switch(e.key){case"/":case'"':html.classList.toggle("paused"),lastTimeText="",togglePIPMode&&(togglePIPMode.lastContent=""),html.classList.contains("paused")?(writeNumber("pausedAt",pausedAt=Date.now()),endsAt=seekEndsAt,o=secToStr(pauseAcum/oneSecond),extraTimeDisp.textContent="+ "+o+" pauses",timerAPI&&timerAPI.send({setVariableValues:{default:secToStr(defaultDuration/1e3),pausing:!0,pauses:o,paused:"0:00"}})):(o=pausedAt?n-pausedAt:0,pausedAt=void 0,seekEndsAt+=o,pauseAcum+=o,writeNumber("pausedAt",pausedAt),writeNumber("pauseAcum",pauseAcum),o=secToStr(pauseAcum/oneSecond),extraTimeDisp.textContent="+ "+o+" pauses",endsAt=seekEndsAt,endsDisp.textContent=local24HourTime(new Date(seekEndsAt)),timerAPI&&timerAPI.send({setVariableValues:{default:secToStr(defaultDuration/1e3),endsAt:endsDisp.textContent,pausing:!1,pauses:o,paused:"0:00"}}));break;case"Tab":case"'":clearHtmlClass("paused"),pausedAt=void 0,pauseAcum=0,writeNumber("pausedAt",pausedAt),writeNumber("pauseAcum",pauseAcum),extraTimeDisp.textContent="",seekEndsAt=startedAt+thisDuration,endsAt=seekEndsAt,endsDisp.textContent=local24HourTime(new Date(seekEndsAt)),timerAPI&&timerAPI.send({setVariableValues:{endsAt:endsDisp.textContent,pauses:"0:00",paused:"0:00"}});break;case".":""!==enterTimeText&&enterTimeText.indexOf(".")<0&&(enterTimeText+=e.key,setHtmlClass("editing"),updateEnteredTimeText());break;case":":""===enterHoursText&&(enterHoursText=enterTimeText,enterTimeText="",setHtmlClass("editing"),dispNextMins.textContent=secToStr(3600*Number(enterHoursText)+60*Number(enterTimeText)));break;case"Backspace":""!==enterTimeText?(enterTimeText=enterTimeText.substr(0,enterTimeText.length-1),updateEnteredTimeText()):(clearHtmlClass("editing"),dispNextMins.textContent=secToStr(defaultDuration/1e3));break;case"Enter":controlling?(lastUpdateTick=0,endsAt=seekEndsAt,clearRemainClass("adjusting"),clearRemainClass("adjustingDown"),keyDisp.textContent=s+" tabs open",writeNumber("endsAt",endsAt)):saveEditedTime();break;case"ArrowDown":html.classList.contains("editing")||(shifting?bumpStart(a):bumpEnd(0-i,0-r),durationDisp.textContent=secToStr((seekEndsAt-startedAt)/1e3),displayUpdate());break;case"q":case"Q":controlling&&is_nwjs()&&require("nw.gui").App.quit();break;case"ArrowUp":html.classList.contains("editing")||(shifting?bumpStart(0-a):bumpEnd(i,r),durationDisp.textContent=secToStr((seekEndsAt-startedAt)/1e3),displayUpdate());break;case"ArrowLeft":bumpStart(0-a),bumpEnd(0-i,0-r),durationDisp.textContent=secToStr((seekEndsAt-startedAt)/1e3),displayUpdate();break;case"ArrowRight":bumpStart(a),bumpEnd(i,r),durationDisp.textContent=secToStr((seekEndsAt-startedAt)/1e3),displayUpdate();break;case"Shift":shifting=!0,setHtmlClass("shifting");break;case"Control":controlling=!0,setHtmlClass("controlling");break;case"i":case"I":controlling&&shifting;break;case"F":case"f":fs_api.isFullscreen()?fs_api.exitFullscreen():fs_api.enterFullscreen();break;case"b":case"B":var o=html.classList.contains("showbar")?0:1;html.classList.toggle("showbar"),writeNumber("showbar",o);break;case"*":case" ":var o=defaultDuration;controlling?(lastUpdateTick=0,endsAt=seekEndsAt,clearRemainClass("adjusting"),clearRemainClass("adjustingDown"),keyDisp.textContent=s+" tabs open",lastTimeText="",writeNumber("endsAt",endsAt)):(saveEditedTime(),(shifting?extendDefaultToCurrentTimer:restartTimer)(),defaultDuration!==o&&(defaultDuration=o,dispNextMins.textContent=secToStr(defaultDuration/1e3),clearHtmlClass("editing"),writeNumber("defaultDuration",defaultDuration)));break;case"m":case"M":html.classList.toggle("showmessages"),writeNumber("showmessages",html.classList.contains("showmessages")?1:0),togglePIPMode&&(togglePIPMode.lastContent=""),lastTimeText="";break;case"t":case"T":o=html.classList.contains("showtimenow")?0:1;html.classList.toggle("showtimenow"),writeNumber("showtimenow",o);break;case"o":case"O":togglePIPMode&&togglePIPMode();break;case"p":case"P":"?presenter"!==window.location.search&&1===s&&(html.classList.toggle("reduced"),o=html.classList.contains("reduced"),runMode=o?"presenter":"controller",timerAPI)&&timerAPI.send({setVariableValues:{showpresenter:o?"1":"0"}}),html.classList[html.classList.contains("reduced")?"remove":"add"]("showbuttons");break;case"s":case"S":e.ctrlKey?(!stylesheet1_obj||e.shiftKey&&(stylesheet1_obj.reset(),!stylesheet1_obj.editing)||stylesheet1_obj.editToggle(),e.preventDefault()):"?presenter"!==window.location.search&&1===s&&(html.classList.add("reduced"),html.classList.add("showbuttons"),runMode="presenter",fs_api.isFullscreen()||fs_api.enterFullscreen(),timerAPI)&&timerAPI.send({setVariableValues:{showpresenter:"1"}});break;case"x":case"X":extendDefaultToCurrentTimer();break;case"c":case"C":html.classList.add("edit_custom_message"),html.classList.remove("show_custom_message"),custom_message.innerText="custom message",custom_message.contentEditable=!0,custom_message.focus(),e.preventDefault();break;case"R":case"r":controlling||(e.preventDefault(),isSingleScreenMode())||"presenter"===runMode&&1===s||openTimerWindow(1<s)}}function isSingleScreenMode(){return!window.location.search.startsWith("?presenter")&&html.classList.contains("reduced")&&html.classList.contains("showbuttons")&&"presenter"===runMode}function saveEditedTime(){""!==enterTimeText&&""!==enterTimeText&&(defaultDuration=1e3*(3600*Number(enterHoursText)+60*Number(enterTimeText)),Date.now()-startedAt<0&&(thisDuration=defaultDuration),enterTimeText="",enterHoursText="",dispNextMins.textContent=secToStr(defaultDuration/1e3),clearHtmlClass("editing"),writeNumber("defaultDuration",defaultDuration),timerAPI)&&timerAPI.send({setVariableValues:{default:dispNextMins.textContent}})}function onDocKeyUp(e){controlling=e.ctrlKey,html.classList[controlling?"add":"remove"]("controlling"),shifting=e.shiftKey,html.classList[shifting?"add":"remove"]("shifting")}function bumpStart(e){startedAt+=e,startedDisp.textContent=local24HourTime(new Date(startedAt)),writeNumber("startedAt",startedAt),lastTimeText="",timerAPI&&timerAPI.send({setVariableValues:{startedAt:startedDisp.textContent}})}function bumpEnd(e,t){seekEndsAt+=e,endsAt+=t,thisDuration=seekEndsAt-startedAt,endsDisp.textContent=local24HourTime(new Date(seekEndsAt)),writeNumber("seekEndsAt",seekEndsAt),lastTimeText="",timerAPI&&timerAPI.send({setVariableValues:{endsAt:endsDisp.textContent}})}function setBarPct(e){progress.style.width=e+"%",localStorage.setItem("barpct",e.toString())}function setBar(e,t){setBarPct(Math.floor(e/t*100))}function readNumber(e,t){e=localStorage.getItem(e);return e?Number(e):t}function writeNumber(e,t){var s;void 0===t?localStorage.removeItem(e):localStorage.setItem(e,t.toString()),timerAPI&&0<=["showtimenow","showmessages","showbar"].indexOf(e)&&((s={})[e]=t.toString()||"0",timerAPI.send({setVariableValues:s}))}function secToStr(e){var t=e<0?"-":"",s=(e<0&&(e=0-e),Math.trunc(e/60)%60),n=Math.trunc(e/3600),e=Math.trunc(e%60),e=(e<10?"0":"")+e.toString();return n<1?t+s.toString()+":"+e:(s=(s<10?"0":"")+s.toString(),t+n.toString()+":"+s+":"+e)}function local24HourTime(e){e=e.toString().split(":");return e[0]=e[0].split(" ").pop(),e[2]=e[2].split(" ")[0],e.join(":")}function timeNowStr(){return local24HourTime(new Date)}function setRemainClass(e){remainDisp.classList.contains(e)||remainDisp.classList.add(e)}function clearRemainClass(e){remainDisp.classList.contains(e)&&remainDisp.classList.remove(e)}function toggleRemainClass(e){remainDisp.classList.toggle(e)}function setHtmlClass(e){html.classList.contains(e)||html.classList.add(e)}function clearHtmlClass(e){html.classList.contains(e)&&html.classList.remove(e)}function onTimerWinUnload(){localStorage.removeItem(timerWin.tab_id),timerWin=void 0}function onControlUnload(){timerWin&&(timerWin.close(),timerWin=void 0),localStorage.removeItem(tab_id),localStorage.removeItem("controller_"+tab_id)}function is_nwjs(){try{return void 0!==require("nw.gui")}catch(e){return!1}}"presenter"===runMode||"http:"!==location.protocol||location.hostname.endsWith(".com")||"function"!=typeof startTimerApi||startTimerApi();